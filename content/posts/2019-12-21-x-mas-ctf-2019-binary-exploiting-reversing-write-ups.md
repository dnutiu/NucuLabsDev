---
author: "Denis Nu\u021Biu"
categories:
- CTF Time
date: '2019-12-21T15:45:20+00:00'
guid: https://nuculabs.dev/?p=672
id: 672
image: /wp-content/uploads/2019/12/469ed-logo.png
layout: post
permalink: /2019/12/21/x-mas-ctf-2019-binary-exploiting-reversing-write-ups/
tags:
- CTF
- write-up
- x-mas
title: 'X-MAS CTF 2019: Binary Exploiting &amp; Reversing Write-Ups'
---
Hello,


Here are my write-ups for the X-MAS CTF 2019 organized by 
.


## **Reversing: Santa’s crackme**


Santa’s crackme is easy to solve when using Ghidra, all you need to do is open up the binary, read the code and use the XOR Memory script from Ghidra.


![](https://i1.wp.com/nuculabs.dev/wp-content/uploads/2019/12/Screenshot-2019-12-14-at-22.12.24.png?fit=1024%2C632&ssl=1)
The flag is retrieved from flag\_matrix and xored by 3.
![](https://i1.wp.com/nuculabs.dev/wp-content/uploads/2019/12/Screenshot-2019-12-14-at-22.23.42.png?fit=1024%2C742&ssl=1)
Select the flag data, right click on Script Manager and execute the XorMemory script
![](/wp-content/uploads/2019/12/50323-screenshot-2019-12-14-at-22.23.56.png)
We get the flag, except for the first character
## **Reversing: X-MAS: Lapland Mission** 


Since this is an Unity game we can easily patch it using dnSpy.


Open **X-MAS Lapland MissionX-MAS\_DataManagedAssembly-CSharp.dll** and navigate to **PlayerControl** class and replace the Die() method with a simple return by clicking edit method and compile.


Play the game, kill all robots and get the flag.


![](https://i0.wp.com/nuculabs.dev/wp-content/uploads/2019/12/flag.png?fit=1024%2C640&ssl=1)
## **Exploitation: SN0WVERFL0W**


To get the flag we need to override the return address of the main function during the buffer overflow.


The buffer size is 10 bytes, the frame address is 8 bytes and the return address is also 8 bytes. We can use Python to create a file with the input we need to pass to the binary:


```
```
python -c "print('a'*10+'a'*8+'x56x11x40x00x00x00x00x00')" > in.txt
```
```


I’ve overridden the return address of main with the return address of the function which prints the flag, you can find that address by inspecting the binary in Ghidra.


![](/wp-content/uploads/2019/12/752fb-pwn.png)